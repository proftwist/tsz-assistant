/* 
 * Определение CSS-переменных для удобства настройки цветовой схемы и других параметров
 * Это позволяет централизованно управлять стилями всего приложения
 */
:root {
    /* Основные цвета приложения */
    --primary-color: #4361ee;      /* Основной цвет (синий) для акцентов */
    --secondary-color: #3f37c9;    /* Вторичный цвет (темно-синий) для градиентов */
    --success-color: #4cc9f0;      /* Цвет успеха (голубой) */
    --danger-color: #f72585;       /* Цвет ошибки/опасности (розовый) */
    --warning-color: #f8961e;      /* Цвет предупреждения (оранжевый) */
    
    /* Цвета для текста и фона */
    --light-color: #f8f9fa;        /* Светлый цвет фона */
    --dark-color: #212529;         /* Темный цвет текста */
    --gray-color: #6c757d;         /* Серый цвет для второстепенных элементов */
    --light-gray: #e9ecef;         /* Светло-серый цвет для границ и фона */
    
    /* Общие параметры дизайна */
    --border-radius: 12px;         /* Радиус скругления углов */
    --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);  /* Тень для элементов */
    --transition: all 0.3s ease;   /* Плавные переходы для анимаций */
}

/* 
 * Сброс стилей по умолчанию для всех элементов
 * Это обеспечивает единообразие отображения в разных браузерах
 */
* {
    margin: 0;           /* Убираем внешние отступы по умолчанию */
    padding: 0;          /* Убираем внутренние отступы по умолчанию */
    box-sizing: border-box;  /* Включаем border-box модель для корректного расчета размеров */
}

/* 
 * Стили для основного тела страницы
 * Задаем фон, шрифт и центрируем контейнер чата
 */
body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;  /* Современный шрифт с запасными вариантами */
    background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);  /* Градиентный фон страницы */
    color: var(--dark-color);       /* Цвет текста по умолчанию */
    line-height: 1.6;               /* Высота строки для лучшей читаемости */
    min-height: 100vh;              /* Минимальная высота равна высоте экрана */
    display: flex;                  /* Используем flexbox для центрирования */
    justify-content: center;        /* Центрируем по горизонтали */
    align-items: center;            /* Центрируем по вертикали */
    padding: 20px;                  /* Внутренний отступ от краев экрана */
}

/* 
 * Основной контейнер чата
 * Создаем карточку с чатом, которая будет содержать все элементы интерфейса
 */
.chat-container {
    width: 100%;                    /* Ширина 100% от родительского элемента */
    max-width: 800px;               /* Максимальная ширина для больших экранов */
    height: 85vh;                   /* Высота 85% от высоты экрана */
    background: rgba(255, 255, 255, 0.95);  /* Полупрозрачный белый фон */
    border-radius: var(--border-radius);    /* Скругленные углы */
    box-shadow: var(--box-shadow);          /* Тень для объемного эффекта */
    display: flex;                  /* Flexbox для расположения элементов */
    flex-direction: column;         /* Вертикальное расположение элементов */
    overflow: hidden;               /* Скрываем содержимое, выходящее за границы */
    backdrop-filter: blur(10px);    /* Эффект размытия фона */
    border: 1px solid rgba(255, 255, 255, 0.5);  /* Полупрозрачная граница */
}

/* 
 * Заголовок чата
 * Создаем привлекательный заголовок с градиентом
 */
.chat-header {
    background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));  /* Градиентный фон */
    color: white;                   /* Белый цвет текста */
    padding: 20px;                  /* Внутренние отступы */
    text-align: center;             /* Центрирование текста */
    font-weight: 600;               /* Полужирный шрифт */
    font-size: 1.4rem;              /* Размер шрифта */
    box-shadow: 0 2px 10px rgba(67, 97, 238, 0.3);  /* Тень для выделения */
}

/* 
 * Область отображения сообщений
 * Создаем прокручиваемую область для истории чата
 */
.chat-box {
    flex: 1;                        /* Занимает всё доступное пространство */
    overflow-y: auto;               /* Вертикальная прокрутка при переполнении */
    padding: 20px;                  /* Внутренние отступы */
    display: flex;                  /* Flexbox для сообщений */
    flex-direction: column;         /* Вертикальное расположение сообщений */
    gap: 15px;                      /* Расстояние между сообщениями */
    /* Фон с едва заметными линиями для визуального разделения */
    background: 
        linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9)),
        repeating-linear-gradient(
            0deg,
            transparent,
            transparent 24px,
            rgba(67, 97, 238, 0.03) 24px,
            rgba(67, 97, 238, 0.03) 25px
        );
}

/* 
 * Стили для отдельных сообщений
 * Общие стили для всех сообщений в чате
 */
.message {
    max-width: 80%;                 /* Максимальная ширина сообщения */
    padding: 15px 20px;             /* Внутренние отступы */
    border-radius: var(--border-radius);  /* Скругленные углы */
    position: relative;             /* Позиционирование для анимаций */
    animation-duration: 0.4s;       /* Длительность анимации */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);  /* Легкая тень */
    line-height: 1.5;               /* Высота строки */
    word-wrap: break-word;          /* Перенос длинных слов */
    transition: var(--transition);  /* Плавные переходы */
}

/* 
 * Эффект при наведении на сообщение
 * Создаем интерактивность при наведении курсора
 */
.message:hover {
    transform: translateY(-2px);    /* Сдвиг вверх при наведении */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);  /* Усиленная тень */
}

/* 
 * Стили для сообщений пользователя
 * Позиционируем справа и задаем синий градиентный фон
 */
.user {
    align-self: flex-end;           /* Выравнивание по правому краю */
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));  /* Градиентный фон */
    color: white;                   /* Белый цвет текста */
    border-bottom-right-radius: 4px;  /* Меньший радиус для "хвостика" сообщения */
}

/* 
 * Стили для сообщений от ИИ
 * Позиционируем слева и задаем белый фон
 */
.llm {
    align-self: flex-start;         /* Выравнивание по левому краю */
    background: white;              /* Белый фон */
    color: var(--dark-color);       /* Темный цвет текста */
    border: 1px solid var(--light-gray);  /* Светло-серая граница */
    border-bottom-left-radius: 4px; /* Меньший радиус для "хвостика" сообщения */
}

/* 
 * Стили для заголовков сообщений (имени отправителя)
 * Выделяем имя отправителя в каждом сообщении
 */
.message strong {
    display: block;                 /* Блочный элемент для переноса строки */
    margin-bottom: 5px;             /* Отступ снизу */
    font-size: 0.9rem;              /* Меньший размер шрифта */
    opacity: 0.9;                   /* Полупрозрачность для второстепенности */
}

/* 
 * Стили для имени отправителя в сообщениях пользователя
 * Делаем его чуть менее контрастным для визуального баланса
 */
.user strong {
    color: rgba(255, 255, 255, 0.9);  /* Полупрозрачный белый цвет */
}

/* 
 * Стили для имени отправителя в сообщениях ИИ
 * Используем основной цвет для выделения */
.llm strong {
    color: var(--primary-color);    /* Синий цвет для имени ИИ */
}

/* 
 * Контейнер для поля ввода сообщения
 * Создаем отдельную область для формы ввода
 */
.chat-input-container {
    padding: 20px;                  /* Внутренние отступы */
    background: white;              /* Белый фон */
    border-top: 1px solid var(--light-gray);  /* Верхняя граница */
}

/* 
 * Форма ввода сообщения
 * Располагаем поле ввода и кнопку в одну строку
 */
#chat-form {
    display: flex;                  /* Flexbox для горизонтального расположения */
    gap: 10px;                      /* Расстояние между элементами */
}

/* 
 * Поле ввода текста сообщения
 * Стилизуем текстовое поле для ввода сообщений
 */
#user-input {
    flex: 1;                        /* Занимает всё доступное пространство */
    padding: 15px 20px;             /* Внутренние отступы */
    border: 2px solid var(--light-gray);  /* Двойная граница */
    border-radius: 50px;            /* Круглые края */
    outline: none;                  /* Убираем стандартный outline */
    font-size: 1rem;                /* Размер шрифта */
    transition: var(--transition);  /* Плавные переходы */
    background: #f8f9fa;            /* Светло-серый фон */
}

/* 
 * Стили для поля ввода при фокусе
 * Выделяем активное поле ввода
 */
#user-input:focus {
    border-color: var(--primary-color);  /* Синяя граница при фокусе */
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);  /* Внутренняя тень */
    background: white;              /* Белый фон при фокусе */
}

/* 
 * Кнопка отправки сообщения
 * Стилизуем кнопку с градиентом и тенью
 */
#chat-form button {
    padding: 15px 30px;             /* Внутренние отступы */
    border: none;                   /* Убираем стандартную границу */
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));  /* Градиентный фон */
    color: white;                   /* Белый цвет текста */
    border-radius: 50px;            /* Круглые края */
    cursor: pointer;                /* Курсор указателя */
    font-weight: 600;               /* Полужирный шрифт */
    font-size: 1rem;                /* Размер шрифта */
    transition: var(--transition);  /* Плавные переходы */
    box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);  /* Тень кнопки */
    display: flex;                  /* Flexbox для центрирования текста */
    align-items: center;            /* Вертикальное центрирование */
    gap: 8px;                       /* Расстояние между элементами внутри кнопки */
}

/* 
 * Стили кнопки при наведении
 * Создаем эффект "выпрыгивания" при наведении
 */
#chat-form button:hover {
    transform: translateY(-2px);    /* Сдвиг вверх */
    box-shadow: 0 6px 20px rgba(67, 97, 238, 0.4);  /* Усиленная тень */
}

/* 
 * Стили кнопки при нажатии
 * Создаем эффект "нажатия"
 */
#chat-form button:active {
    transform: translateY(0);       /* Возвращаем в исходное положение */
}

/* 
 * Стили кнопки во время отправки сообщения
 * Создаем анимацию отправки
 */
#chat-form button.sending {
    transform: scale(0.95);         /* Немного уменьшаем размер */
    box-shadow: 0 2px 8px rgba(67, 97, 238, 0.2);  /* Уменьшаем тень */
}

/* 
 * Стили кнопки в неактивном состоянии
 * Отображаем кнопку как недоступную
 */
#chat-form button:disabled {
    background: var(--light-gray);  /* Светло-серый фон */
    cursor: not-allowed;            /* Курсор "запрещено" */
    transform: none;                /* Убираем трансформации */
    box-shadow: none;               /* Убираем тень */
}

/* 
 * Индикатор загрузки
 * Стили для отображения процесса ожидания ответа
 */
.loading-indicator {
    display: none;                  /* Скрываем по умолчанию */
    align-self: flex-start;         /* Выравнивание по левому краю */
    background: white;              /* Белый фон */
    padding: 15px 20px;             /* Внутренние отступы */
    border-radius: var(--border-radius);  /* Скругленные углы */
    border: 1px solid var(--light-gray);  /* Серая граница */
    margin-bottom: 15px;            /* Отступ снизу */
}

/* 
 * Контейнер для точек загрузки
 * Располагаем точки в ряд
 */
.loading-dots {
    display: flex;                  /* Flexbox для горизонтального расположения */
    gap: 5px;                       /* Расстояние между точками */
}

/* 
 * Стили для отдельных точек загрузки
 * Создаем анимированные точки
 */
.loading-dots span {
    width: 8px;                     /* Ширина точки */
    height: 8px;                    /* Высота точки */
    background: var(--primary-color);  /* Синий цвет */
    border-radius: 50%;             /* Круглая форма */
    display: inline-block;          /* Строчно-блочный элемент */
    animation: bounce 1.5s infinite ease-in-out;  /* Анимация подпрыгивания */
}

/* 
 * Задержка анимации для второй точки
 * Создаем эффект последовательного подпрыгивания
 */
.loading-dots span:nth-child(2) {
    animation-delay: 0.2s;          /* Задержка анимации */
}

/* 
 * Задержка анимации для третьей точки
 * Создаем эффект последовательного подпрыгивания
 */
.loading-dots span:nth-child(3) {
    animation-delay: 0.4s;          /* Задержка анимации */
}

/* 
 * Ключевые кадры анимации подпрыгивания точек
 * Создаем эффект "прыжков" для точек загрузки
 */
@keyframes bounce {
    0%, 100% {
        transform: translateY(0);   /* Исходное положение */
    }
    50% {
        transform: translateY(-5px);  /* Подъем вверх */
    }
}

/* 
 * Ключевые кадры анимации появления сообщений
 * Плавное появление новых сообщений
 */
@keyframes fadeIn {
    from {
        opacity: 0;                 /* Полная прозрачность */
        transform: translateY(10px);  /* Сдвиг вниз */
    }
    to {
        opacity: 1;                 /* Полная непрозрачность */
        transform: translateY(0);   /* Исходное положение */
    }
}

/* 
 * Класс для анимации появления сообщений
 * Применяем анимацию к новым сообщениям
 */
.message.fade-in {
    animation: fadeIn 0.3s ease-out forwards;  /* Анимация появления */
}

/* 
 * Стили для полосы прокрутки
 * Кастомизируем полосу прокрутки для лучшего вида
 */
.chat-box::-webkit-scrollbar {
    width: 8px;                     /* Ширина полосы прокрутки */
}

/* 
 * Стили для трека полосы прокрутки
 * Фон полосы прокрутки
 */
.chat-box::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.02);  /* Полупрозрачный фон */
    border-radius: 4px;             /* Скругленные углы */
}

/* 
 * Стили для "бегунка" полосы прокрутки
 * Основной элемент полосы прокрутки
 */
.chat-box::-webkit-scrollbar-thumb {
    background: var(--light-gray);  /* Светло-серый цвет */
    border-radius: 4px;             /* Скругленные углы */
}

/* 
 * Стили для "бегунка" при наведении
 * Изменяем цвет при наведении
 */
.chat-box::-webkit-scrollbar-thumb:hover {
    background: var(--gray-color);  /* Более темный серый цвет */
}

/* 
 * Адаптивные стили для планшетов и мобильных устройств
 * Оптимизируем отображение на маленьких экранах
 */
@media (max-width: 768px) {
    body {
        padding: 10px;              /* Уменьшаем отступы */
    }
    
    .chat-container {
        height: 95vh;               /* Увеличиваем высоту */
        border-radius: 16px;        /* Больший радиус скругления */
    }
    
    .chat-header {
        padding: 15px;              /* Уменьшаем отступы */
        font-size: 1.2rem;          /* Уменьшаем размер шрифта */
    }
    
    .chat-box {
        padding: 15px;              /* Уменьшаем отступы */
    }
    
    .message {
        max-width: 90%;             /* Увеличиваем ширину сообщений */
        padding: 12px 16px;         /* Уменьшаем отступы */
    }
    
    .chat-input-container {
        padding: 15px;              /* Уменьшаем отступы */
    }
    
    #user-input {
        padding: 12px 16px;         /* Уменьшаем отступы */
    }
    
    #chat-form button {
        padding: 12px 20px;         /* Уменьшаем отступы */
    }
}

/* 
 * Адаптивные стили для очень маленьких экранов
 * Оптимизируем для мобильных телефонов
 */
@media (max-width: 480px) {
    .message {
        max-width: 95%;             /* Почти полная ширина экрана */
    }
    
    #chat-form {
        flex-direction: column;     /* Вертикальное расположение элементов */
    }
    
    #chat-form button {
        width: 100%;                /* Полная ширина кнопки */
        justify-content: center;    /* Центрирование текста в кнопке */
    }
}